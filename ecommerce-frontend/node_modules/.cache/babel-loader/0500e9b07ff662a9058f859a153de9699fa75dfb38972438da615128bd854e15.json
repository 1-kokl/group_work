{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport axios from 'axios';\nconst API_BASE_URL = process.env.VUE_APP_API_BASE_URL || process.env.API_BASE_URL || 'http://localhost:5000';\nconst TOKEN_KEY = 'auth.token';\nconst REFRESH_TOKEN_KEY = 'auth.refreshToken';\nconst EXPIRES_AT_KEY = 'auth.expiresAt';\nconst CSRF_HEADER = 'X-CSRF-Token';\nconst CSRF_STORAGE_KEY = 'auth.csrfToken';\nconst storage = typeof window !== 'undefined' ? window.sessionStorage : null;\nconst http = axios.create({\n  baseURL: API_BASE_URL,\n  timeout: 10000,\n  withCredentials: false,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\nlet activeRequests = 0;\nlet isRefreshing = false;\nlet refreshPromise = null;\nconst refreshSubscribers = [];\nconst ERROR_CODE_MESSAGES = {\n  AUTH_INVALID: '账号或密码错误。',\n  AUTH_LOCKED: '账户已被锁定，请联系管理员。',\n  AUTH_EXPIRED: '登录状态已过期，请重新登录。',\n  VALIDATION_FAILED: '提交的数据验证失败，请检查后重试。',\n  RATE_LIMIT: '请求过于频繁，请稍后再试。',\n  SERVER_ERROR: '服务器开小差了，请稍后再试。'\n};\nfunction readCsrfFromCookie() {\n  if (typeof document === 'undefined') return '';\n  const match = document.cookie.match(/(?:^|;\\s*)csrf_token=([^;]*)/i);\n  return match ? decodeURIComponent(match[1]) : '';\n}\nfunction getCsrfToken() {\n  const stored = storage?.getItem(CSRF_STORAGE_KEY);\n  if (stored) return stored;\n  const cookieToken = readCsrfFromCookie();\n  if (cookieToken) {\n    storage?.setItem(CSRF_STORAGE_KEY, cookieToken);\n  }\n  return cookieToken;\n}\nfunction setCsrfToken(token) {\n  if (!token) return;\n  try {\n    storage?.setItem(CSRF_STORAGE_KEY, token);\n  } catch (error) {\n    console.warn('[HTTP] 存储 CSRF 令牌失败:', error);\n  }\n}\nfunction clearCsrfToken() {\n  storage?.removeItem(CSRF_STORAGE_KEY);\n}\nfunction emitLoadingEvent() {\n  if (typeof window === 'undefined') return;\n  window.dispatchEvent(new CustomEvent('http:loading', {\n    detail: activeRequests > 0\n  }));\n}\nfunction emitErrorEvent(error) {\n  if (typeof window === 'undefined') return;\n  window.dispatchEvent(new CustomEvent('http:error', {\n    detail: error\n  }));\n}\nfunction emitTokenEvent(detail, eventName = 'auth:token-refreshed') {\n  if (typeof window === 'undefined') return;\n  window.dispatchEvent(new CustomEvent(eventName, {\n    detail\n  }));\n}\nfunction decrementRequest() {\n  activeRequests = Math.max(activeRequests - 1, 0);\n  emitLoadingEvent();\n}\nfunction normalizeHttpError(error, fallbackMessage = '请求失败，请稍后重试。') {\n  if (axios.isCancel(error)) {\n    const cancelled = new Error('请求已取消');\n    cancelled.code = 'REQUEST_CANCELLED';\n    cancelled.status = 0;\n    return cancelled;\n  }\n  const status = error?.response?.status ?? 0;\n  const code = error?.response?.data?.code ?? 'UNKNOWN';\n  const message = error?.response?.data?.message || ERROR_CODE_MESSAGES[code] || (status === 0 ? '网络连接异常，请检查网络后重试。' : fallbackMessage);\n  const details = error?.response?.data?.errors || null;\n  const normalized = new Error(message);\n  normalized.code = code;\n  normalized.status = status;\n  normalized.details = details;\n  if (status >= 500 || status === 0) {\n    console.error('[HTTP ERROR]', {\n      status,\n      code,\n      message,\n      details,\n      url: error?.config?.url\n    });\n  }\n  if (!error?.config?.suppressErrorEvent) {\n    emitErrorEvent({\n      ...normalized,\n      message,\n      code,\n      status,\n      details\n    });\n  }\n  return normalized;\n}\nfunction writeTokens({\n  token,\n  refreshToken,\n  expiresAt\n}) {\n  if (token) {\n    storage?.setItem(TOKEN_KEY, token);\n  }\n  if (refreshToken) {\n    storage?.setItem(REFRESH_TOKEN_KEY, refreshToken);\n  }\n  if (expiresAt) {\n    storage?.setItem(EXPIRES_AT_KEY, String(expiresAt));\n  }\n}\nfunction clearTokens() {\n  storage?.removeItem(TOKEN_KEY);\n  storage?.removeItem(REFRESH_TOKEN_KEY);\n  storage?.removeItem(EXPIRES_AT_KEY);\n  clearCsrfToken();\n}\nfunction subscribeTokenRefresh(callback) {\n  refreshSubscribers.push(callback);\n}\nfunction notifySubscribers(error, tokens) {\n  refreshSubscribers.splice(0).forEach(callback => callback(error, tokens));\n}\nasync function requestRefreshToken() {\n  const refreshToken = storage?.getItem(REFRESH_TOKEN_KEY);\n  if (!refreshToken) {\n    throw new Error('缺少刷新令牌');\n  }\n  try {\n    const response = await axios.post(`${API_BASE_URL}/api/v1/user/token/refresh`, {\n      refreshToken\n    }, {\n      timeout: 8000,\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n    const {\n      token,\n      refreshToken: newRefreshToken,\n      expiresIn,\n      csrfToken: responseCsrfToken\n    } = response.data;\n    const expiresAt = Date.now() + Number(expiresIn || 0) * 1000;\n    const tokens = {\n      token,\n      refreshToken: newRefreshToken,\n      expiresAt\n    };\n    writeTokens(tokens);\n    if (responseCsrfToken) {\n      setCsrfToken(responseCsrfToken);\n    }\n    emitTokenEvent(tokens);\n    return tokens;\n  } catch (refreshError) {\n    clearTokens();\n    emitTokenEvent(null, 'auth:token-expired');\n    throw normalizeHttpError(refreshError, '刷新登录状态失败，请重新登录。');\n  }\n}\nhttp.interceptors.request.use(config => {\n  activeRequests += 1;\n  emitLoadingEvent();\n  const token = storage?.getItem(TOKEN_KEY);\n  if (token && !config.headers?.Authorization) {\n    config.headers = config.headers || {};\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  const csrfToken = getCsrfToken();\n  if (csrfToken && !config.headers?.[CSRF_HEADER]) {\n    config.headers = config.headers || {};\n    config.headers[CSRF_HEADER] = csrfToken;\n  }\n  return config;\n}, error => {\n  decrementRequest();\n  return Promise.reject(normalizeHttpError(error));\n});\nhttp.interceptors.response.use(response => {\n  decrementRequest();\n  const csrfFromHeader = response.headers?.[CSRF_HEADER.toLowerCase()] || response.headers?.[CSRF_HEADER];\n  if (csrfFromHeader) {\n    setCsrfToken(csrfFromHeader);\n  }\n  return response.data;\n}, async error => {\n  decrementRequest();\n  const status = error?.response?.status;\n  const config = error?.config || {};\n  if (status === 401 && !config.__isRetryRequest && !config.skipAuthRefresh) {\n    if (!isRefreshing) {\n      isRefreshing = true;\n      refreshPromise = requestRefreshToken().then(tokens => {\n        notifySubscribers(null, tokens);\n        return tokens;\n      }).catch(refreshError => {\n        notifySubscribers(refreshError);\n        throw refreshError;\n      }).finally(() => {\n        isRefreshing = false;\n        refreshPromise = null;\n      });\n    }\n    return new Promise((resolve, reject) => {\n      subscribeTokenRefresh((refreshError, tokens) => {\n        if (refreshError || !tokens?.token) {\n          reject(refreshError || new Error('刷新令牌失败'));\n          return;\n        }\n        config.__isRetryRequest = true;\n        config.headers = config.headers || {};\n        config.headers.Authorization = `Bearer ${tokens.token}`;\n        resolve(http(config));\n      });\n    });\n  }\n  if (status === 401) {\n    clearTokens();\n    emitTokenEvent(null, 'auth:token-expired');\n  }\n  return Promise.reject(normalizeHttpError(error));\n});\nexport { API_BASE_URL, normalizeHttpError };\nexport default http;","map":{"version":3,"names":["axios","API_BASE_URL","process","env","VUE_APP_API_BASE_URL","TOKEN_KEY","REFRESH_TOKEN_KEY","EXPIRES_AT_KEY","CSRF_HEADER","CSRF_STORAGE_KEY","storage","window","sessionStorage","http","create","baseURL","timeout","withCredentials","headers","activeRequests","isRefreshing","refreshPromise","refreshSubscribers","ERROR_CODE_MESSAGES","AUTH_INVALID","AUTH_LOCKED","AUTH_EXPIRED","VALIDATION_FAILED","RATE_LIMIT","SERVER_ERROR","readCsrfFromCookie","document","match","cookie","decodeURIComponent","getCsrfToken","stored","getItem","cookieToken","setItem","setCsrfToken","token","error","console","warn","clearCsrfToken","removeItem","emitLoadingEvent","dispatchEvent","CustomEvent","detail","emitErrorEvent","emitTokenEvent","eventName","decrementRequest","Math","max","normalizeHttpError","fallbackMessage","isCancel","cancelled","Error","code","status","response","data","message","details","errors","normalized","url","config","suppressErrorEvent","writeTokens","refreshToken","expiresAt","String","clearTokens","subscribeTokenRefresh","callback","push","notifySubscribers","tokens","splice","forEach","requestRefreshToken","post","newRefreshToken","expiresIn","csrfToken","responseCsrfToken","Date","now","Number","refreshError","interceptors","request","use","Authorization","Promise","reject","csrfFromHeader","toLowerCase","__isRetryRequest","skipAuthRefresh","then","catch","finally","resolve"],"sources":["C:/Users/Administrator/Desktop/zonshe/ecommerce-frontend/src/services/http.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_BASE_URL =\n  process.env.VUE_APP_API_BASE_URL ||\n  process.env.API_BASE_URL ||\n  'http://localhost:5000';\n\nconst TOKEN_KEY = 'auth.token';\nconst REFRESH_TOKEN_KEY = 'auth.refreshToken';\nconst EXPIRES_AT_KEY = 'auth.expiresAt';\n\nconst CSRF_HEADER = 'X-CSRF-Token';\nconst CSRF_STORAGE_KEY = 'auth.csrfToken';\n\nconst storage = typeof window !== 'undefined' ? window.sessionStorage : null;\n\nconst http = axios.create({\n  baseURL: API_BASE_URL,\n  timeout: 10000,\n  withCredentials: false,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n\nlet activeRequests = 0;\nlet isRefreshing = false;\nlet refreshPromise = null;\nconst refreshSubscribers = [];\n\nconst ERROR_CODE_MESSAGES = {\n  AUTH_INVALID: '账号或密码错误。',\n  AUTH_LOCKED: '账户已被锁定，请联系管理员。',\n  AUTH_EXPIRED: '登录状态已过期，请重新登录。',\n  VALIDATION_FAILED: '提交的数据验证失败，请检查后重试。',\n  RATE_LIMIT: '请求过于频繁，请稍后再试。',\n  SERVER_ERROR: '服务器开小差了，请稍后再试。'\n};\n\nfunction readCsrfFromCookie() {\n  if (typeof document === 'undefined') return '';\n  const match = document.cookie.match(/(?:^|;\\s*)csrf_token=([^;]*)/i);\n  return match ? decodeURIComponent(match[1]) : '';\n}\n\nfunction getCsrfToken() {\n  const stored = storage?.getItem(CSRF_STORAGE_KEY);\n  if (stored) return stored;\n  const cookieToken = readCsrfFromCookie();\n  if (cookieToken) {\n    storage?.setItem(CSRF_STORAGE_KEY, cookieToken);\n  }\n  return cookieToken;\n}\n\nfunction setCsrfToken(token) {\n  if (!token) return;\n  try {\n    storage?.setItem(CSRF_STORAGE_KEY, token);\n  } catch (error) {\n    console.warn('[HTTP] 存储 CSRF 令牌失败:', error);\n  }\n}\n\nfunction clearCsrfToken() {\n  storage?.removeItem(CSRF_STORAGE_KEY);\n}\n\nfunction emitLoadingEvent() {\n  if (typeof window === 'undefined') return;\n  window.dispatchEvent(\n    new CustomEvent('http:loading', {\n      detail: activeRequests > 0\n    })\n  );\n}\n\nfunction emitErrorEvent(error) {\n  if (typeof window === 'undefined') return;\n  window.dispatchEvent(\n    new CustomEvent('http:error', {\n      detail: error\n    })\n  );\n}\n\nfunction emitTokenEvent(detail, eventName = 'auth:token-refreshed') {\n  if (typeof window === 'undefined') return;\n  window.dispatchEvent(new CustomEvent(eventName, { detail }));\n}\n\nfunction decrementRequest() {\n  activeRequests = Math.max(activeRequests - 1, 0);\n  emitLoadingEvent();\n}\n\nfunction normalizeHttpError(error, fallbackMessage = '请求失败，请稍后重试。') {\n  if (axios.isCancel(error)) {\n    const cancelled = new Error('请求已取消');\n    cancelled.code = 'REQUEST_CANCELLED';\n    cancelled.status = 0;\n    return cancelled;\n  }\n\n  const status = error?.response?.status ?? 0;\n  const code = error?.response?.data?.code ?? 'UNKNOWN';\n  const message =\n    error?.response?.data?.message ||\n    ERROR_CODE_MESSAGES[code] ||\n    (status === 0\n      ? '网络连接异常，请检查网络后重试。'\n      : fallbackMessage);\n  const details = error?.response?.data?.errors || null;\n\n  const normalized = new Error(message);\n  normalized.code = code;\n  normalized.status = status;\n  normalized.details = details;\n\n  if (status >= 500 || status === 0) {\n    console.error('[HTTP ERROR]', {\n      status,\n      code,\n      message,\n      details,\n      url: error?.config?.url\n    });\n  }\n\n  if (!error?.config?.suppressErrorEvent) {\n    emitErrorEvent({\n      ...normalized,\n      message,\n      code,\n      status,\n      details\n    });\n  }\n\n  return normalized;\n}\n\nfunction writeTokens({ token, refreshToken, expiresAt }) {\n  if (token) {\n    storage?.setItem(TOKEN_KEY, token);\n  }\n  if (refreshToken) {\n    storage?.setItem(REFRESH_TOKEN_KEY, refreshToken);\n  }\n  if (expiresAt) {\n    storage?.setItem(EXPIRES_AT_KEY, String(expiresAt));\n  }\n}\n\nfunction clearTokens() {\n  storage?.removeItem(TOKEN_KEY);\n  storage?.removeItem(REFRESH_TOKEN_KEY);\n  storage?.removeItem(EXPIRES_AT_KEY);\n  clearCsrfToken();\n}\n\nfunction subscribeTokenRefresh(callback) {\n  refreshSubscribers.push(callback);\n}\n\nfunction notifySubscribers(error, tokens) {\n  refreshSubscribers.splice(0).forEach((callback) => callback(error, tokens));\n}\n\nasync function requestRefreshToken() {\n  const refreshToken = storage?.getItem(REFRESH_TOKEN_KEY);\n  if (!refreshToken) {\n    throw new Error('缺少刷新令牌');\n  }\n\n  try {\n    const response = await axios.post(\n      `${API_BASE_URL}/api/v1/user/token/refresh`,\n      { refreshToken },\n      {\n        timeout: 8000,\n        headers: { 'Content-Type': 'application/json' }\n      }\n    );\n    const {\n      token,\n      refreshToken: newRefreshToken,\n      expiresIn,\n      csrfToken: responseCsrfToken\n    } = response.data;\n    const expiresAt = Date.now() + Number(expiresIn || 0) * 1000;\n    const tokens = { token, refreshToken: newRefreshToken, expiresAt };\n    writeTokens(tokens);\n    if (responseCsrfToken) {\n      setCsrfToken(responseCsrfToken);\n    }\n    emitTokenEvent(tokens);\n    return tokens;\n  } catch (refreshError) {\n    clearTokens();\n    emitTokenEvent(null, 'auth:token-expired');\n    throw normalizeHttpError(refreshError, '刷新登录状态失败，请重新登录。');\n  }\n}\n\nhttp.interceptors.request.use(\n  (config) => {\n    activeRequests += 1;\n    emitLoadingEvent();\n\n    const token = storage?.getItem(TOKEN_KEY);\n    if (token && !config.headers?.Authorization) {\n      config.headers = config.headers || {};\n      config.headers.Authorization = `Bearer ${token}`;\n    }\n\n    const csrfToken = getCsrfToken();\n    if (csrfToken && !config.headers?.[CSRF_HEADER]) {\n      config.headers = config.headers || {};\n      config.headers[CSRF_HEADER] = csrfToken;\n    }\n\n    return config;\n  },\n  (error) => {\n    decrementRequest();\n    return Promise.reject(normalizeHttpError(error));\n  }\n);\n\nhttp.interceptors.response.use(\n  (response) => {\n    decrementRequest();\n    const csrfFromHeader =\n      response.headers?.[CSRF_HEADER.toLowerCase()] ||\n      response.headers?.[CSRF_HEADER];\n    if (csrfFromHeader) {\n      setCsrfToken(csrfFromHeader);\n    }\n    return response.data;\n  },\n  async (error) => {\n    decrementRequest();\n\n    const status = error?.response?.status;\n    const config = error?.config || {};\n\n    if (\n      status === 401 &&\n      !config.__isRetryRequest &&\n      !config.skipAuthRefresh\n    ) {\n      if (!isRefreshing) {\n        isRefreshing = true;\n        refreshPromise = requestRefreshToken()\n          .then((tokens) => {\n            notifySubscribers(null, tokens);\n            return tokens;\n          })\n          .catch((refreshError) => {\n            notifySubscribers(refreshError);\n            throw refreshError;\n          })\n          .finally(() => {\n            isRefreshing = false;\n            refreshPromise = null;\n          });\n      }\n\n      return new Promise((resolve, reject) => {\n        subscribeTokenRefresh((refreshError, tokens) => {\n          if (refreshError || !tokens?.token) {\n            reject(refreshError || new Error('刷新令牌失败'));\n            return;\n          }\n\n          config.__isRetryRequest = true;\n          config.headers = config.headers || {};\n          config.headers.Authorization = `Bearer ${tokens.token}`;\n          resolve(http(config));\n        });\n      });\n    }\n\n    if (status === 401) {\n      clearTokens();\n      emitTokenEvent(null, 'auth:token-expired');\n    }\n\n    return Promise.reject(normalizeHttpError(error));\n  }\n);\n\nexport { API_BASE_URL, normalizeHttpError };\nexport default http;\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}