{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\n/**\r\n * HTML 实体映射表，用于将特殊字符转换为安全的文本表示\r\n */\nconst HTML_ESCAPE_MAP = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#39;',\n  '`': '&#96;'\n};\n\n/**\r\n * 将潜在危险的 HTML 字符进行转义\r\n * @param {string} value 待转义的字符串\r\n * @returns {string} 已转义的安全字符串\r\n */\nexport function escapeHTML(value = '') {\n  return String(value).replace(/[&<>\"'`]/g, match => HTML_ESCAPE_MAP[match]);\n}\n\n/**\r\n * 基础的 XSS 输入过滤\r\n * - 去除 script、style、iframe 标签\r\n * - 移除内联事件（例如 onclick）\r\n * - 对剩余文本进行 HTML 转义\r\n * @param {string} value 用户输入的原始字符串\r\n * @returns {string} 过滤后的安全字符串\r\n */\nexport function sanitizeInput(value = '') {\n  return escapeHTML(String(value).replace(/<(script|style|iframe)[^>]*>.*?<\\/\\1>/gi, '').replace(/\\son\\w+=\"[^\"]*\"/gi, '').replace(/\\son\\w+='[^']*'/gi, ''));\n}\n\n/**\r\n * 通用表单校验器\r\n * @param {Record<string, any>} fields 待校验的字段对象\r\n * @param {Record<string, Function>} validators 与字段对应的校验函数\r\n * @returns {{ valid: boolean; errors: Record<string, string> }}\r\n */\nexport function validateForm(fields, validators) {\n  const errors = {};\n  Object.entries(validators || {}).forEach(([key, validator]) => {\n    if (typeof validator !== 'function') return;\n    const result = validator(fields?.[key]);\n    if (result !== true) {\n      errors[key] = typeof result === 'string' ? result : '请输入有效的内容';\n    }\n  });\n  return {\n    valid: Object.keys(errors).length === 0,\n    errors\n  };\n}\n\n/**\r\n * 密码强度验证\r\n * - 至少 8 位\r\n * - 同时包含大写、小写、数字、特殊字符中的任意三种\r\n * @param {string} password 密码原文\r\n * @returns {{ valid: boolean; score: number; feedback: string[] }}\r\n */\nexport function validatePasswordStrength(password = '') {\n  const feedback = [];\n  const checks = {\n    length: password.length >= 8,\n    upper: /[A-Z]/.test(password),\n    lower: /[a-z]/.test(password),\n    number: /\\d/.test(password),\n    special: /[!@#$%^&*()]/.test(password)\n  };\n  if (!checks.length) feedback.push('密码长度至少 8 位。');\n  if (!checks.upper) feedback.push('需包含大写字母。');\n  if (!checks.lower) feedback.push('需包含小写字母。');\n  if (!checks.number) feedback.push('需包含数字。');\n  if (!checks.special) feedback.push('需包含特殊符号 !@#$%^&*() 中至少一个。');\n  const score = Object.values(checks).filter(Boolean).length;\n  const valid = checks.length && checks.upper && checks.lower && checks.number && checks.special;\n  return {\n    valid,\n    score,\n    feedback\n  };\n}\n\n/**\r\n * 国内手机号格式校验（中国大陆）\r\n * @param {string} phone 手机号\r\n * @returns {true|string} true 表示通过，其余返回错误提示\r\n */\nexport function validatePhoneNumber(phone = '') {\n  if (!/^1[3-9]\\d{9}$/.test(phone)) {\n    return '请输入正确的 11 位手机号。';\n  }\n  return true;\n}\n\n/**\r\n * 用户名格式校验\r\n * - 以字母开头\r\n * - 允许数字与下划线\r\n * - 长度 4-18 位\r\n * @param {string} username 用户名\r\n * @returns {true|string} true 表示通过，其余返回错误提示\r\n */\nexport function validateUsername(username = '') {\n  if (!/^[A-Za-z0-9_]{6,20}$/.test(username)) {\n    return '用户名需为 6-20 位的字母、数字或下划线组合。';\n  }\n  return true;\n}","map":{"version":3,"names":["HTML_ESCAPE_MAP","escapeHTML","value","String","replace","match","sanitizeInput","validateForm","fields","validators","errors","Object","entries","forEach","key","validator","result","valid","keys","length","validatePasswordStrength","password","feedback","checks","upper","test","lower","number","special","push","score","values","filter","Boolean","validatePhoneNumber","phone","validateUsername","username"],"sources":["C:/Users/Administrator/Desktop/zonshe/ecommerce-frontend/src/utils/security.js"],"sourcesContent":["/**\r\n * HTML 实体映射表，用于将特殊字符转换为安全的文本表示\r\n */\r\nconst HTML_ESCAPE_MAP = {\r\n  '&': '&amp;',\r\n  '<': '&lt;',\r\n  '>': '&gt;',\r\n  '\"': '&quot;',\r\n  \"'\": '&#39;',\r\n  '`': '&#96;'\r\n};\r\n\r\n/**\r\n * 将潜在危险的 HTML 字符进行转义\r\n * @param {string} value 待转义的字符串\r\n * @returns {string} 已转义的安全字符串\r\n */\r\nexport function escapeHTML(value = '') {\r\n  return String(value).replace(/[&<>\"'`]/g, (match) => HTML_ESCAPE_MAP[match]);\r\n}\r\n\r\n/**\r\n * 基础的 XSS 输入过滤\r\n * - 去除 script、style、iframe 标签\r\n * - 移除内联事件（例如 onclick）\r\n * - 对剩余文本进行 HTML 转义\r\n * @param {string} value 用户输入的原始字符串\r\n * @returns {string} 过滤后的安全字符串\r\n */\r\nexport function sanitizeInput(value = '') {\r\n  return escapeHTML(\r\n    String(value)\r\n      .replace(/<(script|style|iframe)[^>]*>.*?<\\/\\1>/gi, '')\r\n      .replace(/\\son\\w+=\"[^\"]*\"/gi, '')\r\n      .replace(/\\son\\w+='[^']*'/gi, '')\r\n  );\r\n}\r\n\r\n/**\r\n * 通用表单校验器\r\n * @param {Record<string, any>} fields 待校验的字段对象\r\n * @param {Record<string, Function>} validators 与字段对应的校验函数\r\n * @returns {{ valid: boolean; errors: Record<string, string> }}\r\n */\r\nexport function validateForm(fields, validators) {\r\n  const errors = {};\r\n  Object.entries(validators || {}).forEach(([key, validator]) => {\r\n    if (typeof validator !== 'function') return;\r\n\r\n    const result = validator(fields?.[key]);\r\n\r\n    if (result !== true) {\r\n      errors[key] = typeof result === 'string' ? result : '请输入有效的内容';\r\n    }\r\n  });\r\n\r\n  return {\r\n    valid: Object.keys(errors).length === 0,\r\n    errors\r\n  };\r\n}\r\n\r\n/**\r\n * 密码强度验证\r\n * - 至少 8 位\r\n * - 同时包含大写、小写、数字、特殊字符中的任意三种\r\n * @param {string} password 密码原文\r\n * @returns {{ valid: boolean; score: number; feedback: string[] }}\r\n */\r\nexport function validatePasswordStrength(password = '') {\r\n  const feedback = [];\r\n  const checks = {\r\n    length: password.length >= 8,\r\n    upper: /[A-Z]/.test(password),\r\n    lower: /[a-z]/.test(password),\r\n    number: /\\d/.test(password),\r\n    special: /[!@#$%^&*()]/.test(password)\r\n  };\r\n\r\n  if (!checks.length) feedback.push('密码长度至少 8 位。');\r\n  if (!checks.upper) feedback.push('需包含大写字母。');\r\n  if (!checks.lower) feedback.push('需包含小写字母。');\r\n  if (!checks.number) feedback.push('需包含数字。');\r\n  if (!checks.special) feedback.push('需包含特殊符号 !@#$%^&*() 中至少一个。');\r\n\r\n  const score = Object.values(checks).filter(Boolean).length;\r\n  const valid =\r\n    checks.length &&\r\n    checks.upper &&\r\n    checks.lower &&\r\n    checks.number &&\r\n    checks.special;\r\n\r\n  return {\r\n    valid,\r\n    score,\r\n    feedback\r\n  };\r\n}\r\n\r\n/**\r\n * 国内手机号格式校验（中国大陆）\r\n * @param {string} phone 手机号\r\n * @returns {true|string} true 表示通过，其余返回错误提示\r\n */\r\nexport function validatePhoneNumber(phone = '') {\r\n  if (!/^1[3-9]\\d{9}$/.test(phone)) {\r\n    return '请输入正确的 11 位手机号。';\r\n  }\r\n  return true;\r\n}\r\n\r\n/**\r\n * 用户名格式校验\r\n * - 以字母开头\r\n * - 允许数字与下划线\r\n * - 长度 4-18 位\r\n * @param {string} username 用户名\r\n * @returns {true|string} true 表示通过，其余返回错误提示\r\n */\r\nexport function validateUsername(username = '') {\r\n  if (!/^[A-Za-z0-9_]{6,20}$/.test(username)) {\r\n    return '用户名需为 6-20 位的字母、数字或下划线组合。';\r\n  }\r\n  return true;\r\n}\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}