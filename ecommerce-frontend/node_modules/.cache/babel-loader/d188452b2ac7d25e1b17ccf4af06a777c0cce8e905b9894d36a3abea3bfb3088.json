{"ast":null,"code":"import { createStore } from 'vuex';\nimport auth from './modules/auth';\nimport user from './modules/user';\nfunction createAuthCleanupPlugin() {\n  return store => {\n    store.subscribe(mutation => {\n      if (mutation.type === 'auth/RESET_AUTH') {\n        store.commit('user/RESET_PROFILE');\n      }\n    });\n  };\n}\nfunction createEventBridgePlugin() {\n  return store => {\n    if (typeof window === 'undefined') return;\n    window.addEventListener('auth:token-refreshed', event => {\n      if (!event?.detail) return;\n      store.dispatch('auth/syncTokens', event.detail);\n      store.commit('auth/SET_STATUS', 'authenticated');\n    });\n    window.addEventListener('auth:token-expired', () => {\n      store.dispatch('auth/forceLogout');\n    });\n    window.addEventListener('http:loading', event => {\n      store.commit('SET_GLOBAL_LOADING', Boolean(event?.detail));\n    });\n    window.addEventListener('http:error', event => {\n      if (event?.detail) {\n        store.commit('SET_GLOBAL_ERROR', event.detail);\n      }\n    });\n  };\n}\nconst store = createStore({\n  state: () => ({\n    globalLoading: false,\n    globalError: null\n  }),\n  getters: {\n    globalLoading: state => state.globalLoading,\n    globalError: state => state.globalError\n  },\n  mutations: {\n    SET_GLOBAL_LOADING(state, value) {\n      state.globalLoading = Boolean(value);\n    },\n    SET_GLOBAL_ERROR(state, error) {\n      state.globalError = error || null;\n    }\n  },\n  modules: {\n    auth,\n    user\n  },\n  strict: process.env.NODE_ENV !== 'production',\n  plugins: [createAuthCleanupPlugin(), createEventBridgePlugin()]\n});\nexport default store;","map":{"version":3,"names":["createStore","auth","user","createAuthCleanupPlugin","store","subscribe","mutation","type","commit","createEventBridgePlugin","window","addEventListener","event","detail","dispatch","Boolean","state","globalLoading","globalError","getters","mutations","SET_GLOBAL_LOADING","value","SET_GLOBAL_ERROR","error","modules","strict","process","env","NODE_ENV","plugins"],"sources":["C:/Users/Administrator/Desktop/zonshe/ecommerce-frontend/src/store/index.js"],"sourcesContent":["import { createStore } from 'vuex';\nimport auth from './modules/auth';\nimport user from './modules/user';\n\nfunction createAuthCleanupPlugin() {\n  return (store) => {\n    store.subscribe((mutation) => {\n      if (mutation.type === 'auth/RESET_AUTH') {\n        store.commit('user/RESET_PROFILE');\n      }\n    });\n  };\n}\n\nfunction createEventBridgePlugin() {\n  return (store) => {\n    if (typeof window === 'undefined') return;\n\n    window.addEventListener('auth:token-refreshed', (event) => {\n      if (!event?.detail) return;\n      store.dispatch('auth/syncTokens', event.detail);\n      store.commit('auth/SET_STATUS', 'authenticated');\n    });\n\n    window.addEventListener('auth:token-expired', () => {\n      store.dispatch('auth/forceLogout');\n    });\n\n    window.addEventListener('http:loading', (event) => {\n      store.commit('SET_GLOBAL_LOADING', Boolean(event?.detail));\n    });\n\n    window.addEventListener('http:error', (event) => {\n      if (event?.detail) {\n        store.commit('SET_GLOBAL_ERROR', event.detail);\n      }\n    });\n  };\n}\n\nconst store = createStore({\n  state: () => ({\n    globalLoading: false,\n    globalError: null\n  }),\n  getters: {\n    globalLoading: (state) => state.globalLoading,\n    globalError: (state) => state.globalError\n  },\n  mutations: {\n    SET_GLOBAL_LOADING(state, value) {\n      state.globalLoading = Boolean(value);\n    },\n    SET_GLOBAL_ERROR(state, error) {\n      state.globalError = error || null;\n    }\n  },\n  modules: {\n    auth,\n    user\n  },\n  strict: process.env.NODE_ENV !== 'production',\n  plugins: [createAuthCleanupPlugin(), createEventBridgePlugin()]\n});\n\nexport default store;\n\n"],"mappings":"AAAA,SAASA,WAAW,QAAQ,MAAM;AAClC,OAAOC,IAAI,MAAM,gBAAgB;AACjC,OAAOC,IAAI,MAAM,gBAAgB;AAEjC,SAASC,uBAAuBA,CAAA,EAAG;EACjC,OAAQC,KAAK,IAAK;IAChBA,KAAK,CAACC,SAAS,CAAEC,QAAQ,IAAK;MAC5B,IAAIA,QAAQ,CAACC,IAAI,KAAK,iBAAiB,EAAE;QACvCH,KAAK,CAACI,MAAM,CAAC,oBAAoB,CAAC;MACpC;IACF,CAAC,CAAC;EACJ,CAAC;AACH;AAEA,SAASC,uBAAuBA,CAAA,EAAG;EACjC,OAAQL,KAAK,IAAK;IAChB,IAAI,OAAOM,MAAM,KAAK,WAAW,EAAE;IAEnCA,MAAM,CAACC,gBAAgB,CAAC,sBAAsB,EAAGC,KAAK,IAAK;MACzD,IAAI,CAACA,KAAK,EAAEC,MAAM,EAAE;MACpBT,KAAK,CAACU,QAAQ,CAAC,iBAAiB,EAAEF,KAAK,CAACC,MAAM,CAAC;MAC/CT,KAAK,CAACI,MAAM,CAAC,iBAAiB,EAAE,eAAe,CAAC;IAClD,CAAC,CAAC;IAEFE,MAAM,CAACC,gBAAgB,CAAC,oBAAoB,EAAE,MAAM;MAClDP,KAAK,CAACU,QAAQ,CAAC,kBAAkB,CAAC;IACpC,CAAC,CAAC;IAEFJ,MAAM,CAACC,gBAAgB,CAAC,cAAc,EAAGC,KAAK,IAAK;MACjDR,KAAK,CAACI,MAAM,CAAC,oBAAoB,EAAEO,OAAO,CAACH,KAAK,EAAEC,MAAM,CAAC,CAAC;IAC5D,CAAC,CAAC;IAEFH,MAAM,CAACC,gBAAgB,CAAC,YAAY,EAAGC,KAAK,IAAK;MAC/C,IAAIA,KAAK,EAAEC,MAAM,EAAE;QACjBT,KAAK,CAACI,MAAM,CAAC,kBAAkB,EAAEI,KAAK,CAACC,MAAM,CAAC;MAChD;IACF,CAAC,CAAC;EACJ,CAAC;AACH;AAEA,MAAMT,KAAK,GAAGJ,WAAW,CAAC;EACxBgB,KAAK,EAAEA,CAAA,MAAO;IACZC,aAAa,EAAE,KAAK;IACpBC,WAAW,EAAE;EACf,CAAC,CAAC;EACFC,OAAO,EAAE;IACPF,aAAa,EAAGD,KAAK,IAAKA,KAAK,CAACC,aAAa;IAC7CC,WAAW,EAAGF,KAAK,IAAKA,KAAK,CAACE;EAChC,CAAC;EACDE,SAAS,EAAE;IACTC,kBAAkBA,CAACL,KAAK,EAAEM,KAAK,EAAE;MAC/BN,KAAK,CAACC,aAAa,GAAGF,OAAO,CAACO,KAAK,CAAC;IACtC,CAAC;IACDC,gBAAgBA,CAACP,KAAK,EAAEQ,KAAK,EAAE;MAC7BR,KAAK,CAACE,WAAW,GAAGM,KAAK,IAAI,IAAI;IACnC;EACF,CAAC;EACDC,OAAO,EAAE;IACPxB,IAAI;IACJC;EACF,CAAC;EACDwB,MAAM,EAAEC,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,YAAY;EAC7CC,OAAO,EAAE,CAAC3B,uBAAuB,CAAC,CAAC,EAAEM,uBAAuB,CAAC,CAAC;AAChE,CAAC,CAAC;AAEF,eAAeL,KAAK","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}