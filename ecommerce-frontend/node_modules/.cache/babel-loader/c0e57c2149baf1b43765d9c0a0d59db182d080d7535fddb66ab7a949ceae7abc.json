{"ast":null,"code":"import { createStore } from 'vuex';\nimport auth from './modules/auth';\nimport user from './modules/user';\nfunction createAuthCleanupPlugin() {\n  return store => {\n    store.subscribe(mutation => {\n      if (mutation.type === 'auth/RESET_AUTH') {\n        store.commit('user/RESET_PROFILE');\n      }\n    });\n  };\n}\nfunction createEventBridgePlugin() {\n  return store => {\n    if (typeof window === 'undefined') return;\n    window.addEventListener('auth:token-refreshed', event => {\n      if (!event?.detail) return;\n      store.dispatch('auth/syncTokens', event.detail);\n      store.commit('auth/SET_STATUS', 'authenticated');\n    });\n    window.addEventListener('auth:token-expired', () => {\n      store.dispatch('auth/forceLogout');\n    });\n    window.addEventListener('http:loading', event => {\n      store.commit('SET_GLOBAL_LOADING', Boolean(event?.detail));\n    });\n    window.addEventListener('http:error', event => {\n      const detail = event?.detail;\n      if (!detail || detail.suppressGlobalError) {\n        return;\n      }\n      store.commit('SET_GLOBAL_ERROR', detail);\n    });\n  };\n}\nconst store = createStore({\n  state: () => ({\n    globalLoading: false,\n    globalError: null\n  }),\n  getters: {\n    globalLoading: state => state.globalLoading,\n    globalError: state => state.globalError\n  },\n  mutations: {\n    SET_GLOBAL_LOADING(state, value) {\n      state.globalLoading = Boolean(value);\n    },\n    SET_GLOBAL_ERROR(state, error) {\n      state.globalError = error || null;\n    }\n  },\n  modules: {\n    auth,\n    user\n  },\n  strict: process.env.NODE_ENV !== 'production',\n  plugins: [createAuthCleanupPlugin(), createEventBridgePlugin()]\n});\nexport default store;","map":{"version":3,"names":["createStore","auth","user","createAuthCleanupPlugin","store","subscribe","mutation","type","commit","createEventBridgePlugin","window","addEventListener","event","detail","dispatch","Boolean","suppressGlobalError","state","globalLoading","globalError","getters","mutations","SET_GLOBAL_LOADING","value","SET_GLOBAL_ERROR","error","modules","strict","process","env","NODE_ENV","plugins"],"sources":["C:/Users/Administrator/Desktop/zonshe/ecommerce-frontend/src/store/index.js"],"sourcesContent":["import { createStore } from 'vuex';\r\nimport auth from './modules/auth';\r\nimport user from './modules/user';\r\n\r\nfunction createAuthCleanupPlugin() {\r\n  return (store) => {\r\n    store.subscribe((mutation) => {\r\n      if (mutation.type === 'auth/RESET_AUTH') {\r\n        store.commit('user/RESET_PROFILE');\r\n      }\r\n    });\r\n  };\r\n}\r\n\r\nfunction createEventBridgePlugin() {\r\n  return (store) => {\r\n    if (typeof window === 'undefined') return;\r\n\r\n    window.addEventListener('auth:token-refreshed', (event) => {\r\n      if (!event?.detail) return;\r\n      store.dispatch('auth/syncTokens', event.detail);\r\n      store.commit('auth/SET_STATUS', 'authenticated');\r\n    });\r\n\r\n    window.addEventListener('auth:token-expired', () => {\r\n      store.dispatch('auth/forceLogout');\r\n    });\r\n\r\n    window.addEventListener('http:loading', (event) => {\r\n      store.commit('SET_GLOBAL_LOADING', Boolean(event?.detail));\r\n    });\r\n\r\n    window.addEventListener('http:error', (event) => {\r\n      const detail = event?.detail;\r\n      if (!detail || detail.suppressGlobalError) {\r\n        return;\r\n      }\r\n      store.commit('SET_GLOBAL_ERROR', detail);\r\n    });\r\n  };\r\n}\r\n\r\nconst store = createStore({\r\n  state: () => ({\r\n    globalLoading: false,\r\n    globalError: null\r\n  }),\r\n  getters: {\r\n    globalLoading: (state) => state.globalLoading,\r\n    globalError: (state) => state.globalError\r\n  },\r\n  mutations: {\r\n    SET_GLOBAL_LOADING(state, value) {\r\n      state.globalLoading = Boolean(value);\r\n    },\r\n    SET_GLOBAL_ERROR(state, error) {\r\n      state.globalError = error || null;\r\n    }\r\n  },\r\n  modules: {\r\n    auth,\r\n    user\r\n  },\r\n  strict: process.env.NODE_ENV !== 'production',\r\n  plugins: [createAuthCleanupPlugin(), createEventBridgePlugin()]\r\n});\r\n\r\nexport default store;\r\n\r\n"],"mappings":"AAAA,SAASA,WAAW,QAAQ,MAAM;AAClC,OAAOC,IAAI,MAAM,gBAAgB;AACjC,OAAOC,IAAI,MAAM,gBAAgB;AAEjC,SAASC,uBAAuBA,CAAA,EAAG;EACjC,OAAQC,KAAK,IAAK;IAChBA,KAAK,CAACC,SAAS,CAAEC,QAAQ,IAAK;MAC5B,IAAIA,QAAQ,CAACC,IAAI,KAAK,iBAAiB,EAAE;QACvCH,KAAK,CAACI,MAAM,CAAC,oBAAoB,CAAC;MACpC;IACF,CAAC,CAAC;EACJ,CAAC;AACH;AAEA,SAASC,uBAAuBA,CAAA,EAAG;EACjC,OAAQL,KAAK,IAAK;IAChB,IAAI,OAAOM,MAAM,KAAK,WAAW,EAAE;IAEnCA,MAAM,CAACC,gBAAgB,CAAC,sBAAsB,EAAGC,KAAK,IAAK;MACzD,IAAI,CAACA,KAAK,EAAEC,MAAM,EAAE;MACpBT,KAAK,CAACU,QAAQ,CAAC,iBAAiB,EAAEF,KAAK,CAACC,MAAM,CAAC;MAC/CT,KAAK,CAACI,MAAM,CAAC,iBAAiB,EAAE,eAAe,CAAC;IAClD,CAAC,CAAC;IAEFE,MAAM,CAACC,gBAAgB,CAAC,oBAAoB,EAAE,MAAM;MAClDP,KAAK,CAACU,QAAQ,CAAC,kBAAkB,CAAC;IACpC,CAAC,CAAC;IAEFJ,MAAM,CAACC,gBAAgB,CAAC,cAAc,EAAGC,KAAK,IAAK;MACjDR,KAAK,CAACI,MAAM,CAAC,oBAAoB,EAAEO,OAAO,CAACH,KAAK,EAAEC,MAAM,CAAC,CAAC;IAC5D,CAAC,CAAC;IAEFH,MAAM,CAACC,gBAAgB,CAAC,YAAY,EAAGC,KAAK,IAAK;MAC/C,MAAMC,MAAM,GAAGD,KAAK,EAAEC,MAAM;MAC5B,IAAI,CAACA,MAAM,IAAIA,MAAM,CAACG,mBAAmB,EAAE;QACzC;MACF;MACAZ,KAAK,CAACI,MAAM,CAAC,kBAAkB,EAAEK,MAAM,CAAC;IAC1C,CAAC,CAAC;EACJ,CAAC;AACH;AAEA,MAAMT,KAAK,GAAGJ,WAAW,CAAC;EACxBiB,KAAK,EAAEA,CAAA,MAAO;IACZC,aAAa,EAAE,KAAK;IACpBC,WAAW,EAAE;EACf,CAAC,CAAC;EACFC,OAAO,EAAE;IACPF,aAAa,EAAGD,KAAK,IAAKA,KAAK,CAACC,aAAa;IAC7CC,WAAW,EAAGF,KAAK,IAAKA,KAAK,CAACE;EAChC,CAAC;EACDE,SAAS,EAAE;IACTC,kBAAkBA,CAACL,KAAK,EAAEM,KAAK,EAAE;MAC/BN,KAAK,CAACC,aAAa,GAAGH,OAAO,CAACQ,KAAK,CAAC;IACtC,CAAC;IACDC,gBAAgBA,CAACP,KAAK,EAAEQ,KAAK,EAAE;MAC7BR,KAAK,CAACE,WAAW,GAAGM,KAAK,IAAI,IAAI;IACnC;EACF,CAAC;EACDC,OAAO,EAAE;IACPzB,IAAI;IACJC;EACF,CAAC;EACDyB,MAAM,EAAEC,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,YAAY;EAC7CC,OAAO,EAAE,CAAC5B,uBAAuB,CAAC,CAAC,EAAEM,uBAAuB,CAAC,CAAC;AAChE,CAAC,CAAC;AAEF,eAAeL,KAAK","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}